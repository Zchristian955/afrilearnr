---
title: "test tmap displaying map from earlier chunk"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
```

New issue. 

Two chunks, first chunk makes an orange map, 2nd one makes a blue map.

But, when user presses Run button on the 2nd chunk, the first map is displayed.

Happens on shinyapps but not locally.

Possibly related to issue fixed by RStudio in 2021-02 https://github.com/rstudio/learnr/issues/484


```{r tmap-test-orange, exercise = TRUE, exercise.eval = TRUE, warning=FALSE, message=FALSE}

library(tmap)
tmap_mode("view")
data("World")

tm_shape(World) +
    tm_polygons("HPI")


```


```{r tmap-test-blue, exercise = TRUE, exercise.eval = TRUE, warning=FALSE, message=FALSE}

library(tmap)
tmap_mode("view")
data("World")

tm_shape(World) +
    tm_polygons("HPI", palette='Blues')

```
